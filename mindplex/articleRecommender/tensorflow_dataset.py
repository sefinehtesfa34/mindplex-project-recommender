import pandas as pd
import tensorflow as tf 
class ListofRatings:
  def __init__(self,ratings) -> None:
    self.list_of_dicts=list(ratings.apply(self.func).as_numpy_iterator())
  def func(self,ds):
    return ds.filter(lambda x:x.get("userId",None)!=None)

  def returnListOfRatings(self):
    return self.list_of_dicts
  
   






# e.g [
#   {
#    userId:    b'17364785',
#    contentId: b'9797765',
#    rating:    3
#    },
#   {
#    userId:    b'19084785',
#    contentId: b'0797765',
#    rating:    4
#    },
    
#   ]
# 
# 
# 
"""
This is the output for the list(ratings.apply(func).as_numpy_iterator())
     
[{'userId': b'-8845298781299428018',
  'contentId': b'-7292285110016212249',
  'rating': 3},
 {'userId': b'-1032019229384696495',
  'contentId': b'-6151852268067518688',
  'rating': 2},
 {'userId': b'-1130272294246983140',
  'contentId': b'2448026894306402386',
  'rating': 1},
 {'userId': b'344280948527967603',
  'contentId': b'-2826566343807132236',
  'rating': 2},
 {'userId': b'-445337111692715325',
  'contentId': b'-2148899391355011268',
  'rating': 2},
 {'userId': b'-8763398617720485024',
  'contentId': b'4119190424078847945',
  'rating': 2},
 {'userId': b'3609194402293569455',
  'contentId': b'-7926018713416777892',
  'rating': 2},
 {'userId': b'4254153380739593270',
  'contentId': b'3353902017498793780',
  'rating': 2},
 {'userId': b'344280948527967603',
  'contentId': b'-9157338616628196758',
  'rating': 4},
 {'userId': b'3609194402293569455',
  'contentId': b'1805789466376069146',
  'rating': 3},
 {'userId': b'3609194402293569455',
  'contentId': b'-2081760549863309770',
  'rating': 1},
 {'userId': b'1908339160857512799',
  'contentId': b'-5170198873410718233',
  'rating': 4},
 {'userId': b'1908339160857512799',
  'contentId': b'-3367778232969996503',
  'rating': 5},
 {'userId': b'1908339160857512799',
  'contentId': b'4988225165850707692',
  'rating': 3},
 {'userId': b'7781822014935525018',
  'contentId': b'-5917314377186856799',
  'rating': 5},
 {'userId': b'8239286975497580612',
  'contentId': b'6157037646878010131',
  'rating': 4},
 {'userId': b'8239286975497580612',
  'contentId': b'6023609667389715259',
  'rating': 2},
 {'userId': b'-445337111692715325',
  'contentId': b'7905485530310717815',
  'rating': 1},
 {'userId': b'2766187446275090740',
  'contentId': b'8194079557551008273',
  'rating': 4},
 {'userId': b'1908339160857512799',
  'contentId': b'-1672166631728511207',
  'rating': 5},
 {'userId': b'-1130272294246983140',
  'contentId': b'-4374331682165863764',
  'rating': 1},
 {'userId': b'8239286975497580612',
  'contentId': b'5714314286511882372',
  'rating': 5},
 {'userId': b'4254153380739593270',
  'contentId': b'-6451309518266745024',
  'rating': 4},
 {'userId': b'-8763398617720485024',
  'contentId': b'-4110354420726924665',
  'rating': 4},
 {'userId': b'8239286975497580612',
  'contentId': b'-7292285110016212249',
  'rating': 3},
 {'userId': b'3609194402293569455',
  'contentId': b'-6151852268067518688',
  'rating': 3},
 {'userId': b'1908339160857512799',
  'contentId': b'2448026894306402386',
  'rating': 2},
 {'userId': b'-8763398617720485024',
  'contentId': b'-2826566343807132236',
  'rating': 4},
 {'userId': b'3609194402293569455',
  'contentId': b'-2148899391355011268',
  'rating': 5},
 {'userId': b'-1479311724257856983',
  'contentId': b'4119190424078847945',
  'rating': 4},
 {'userId': b'3609194402293569455',
  'contentId': b'-7926018713416777892',
  'rating': 3},
 {'userId': b'3609194402293569455',
  'contentId': b'3353902017498793780',
  'rating': 2},
 {'userId': b'3609194402293569455',
  'contentId': b'-9157338616628196758',
  'rating': 4},
 {'userId': b'1908339160857512799',
  'contentId': b'1805789466376069146',
  'rating': 1},
 {'userId': b'-8845298781299428018',
  'contentId': b'-2081760549863309770',
  'rating': 4},
 {'userId': b'2766187446275090740',
  'contentId': b'-5170198873410718233',
  'rating': 1},
 {'userId': b'3609194402293569455',
  'contentId': b'-3367778232969996503',
  'rating': 2},
 {'userId': b'344280948527967603',
  'contentId': b'4988225165850707692',
  'rating': 1},
 {'userId': b'1908339160857512799',
  'contentId': b'-5917314377186856799',
  'rating': 3},
 {'userId': b'3609194402293569455',
  'contentId': b'6157037646878010131',
  'rating': 1},
 {'userId': b'344280948527967603',
  'contentId': b'6023609667389715259',
  'rating': 2},
 {'userId': b'-108842214936804958',
  'contentId': b'7905485530310717815',
  'rating': 5},
 {'userId': b'3609194402293569455',
  'contentId': b'8194079557551008273',
  'rating': 2},
 {'userId': b'-8763398617720485024',
  'contentId': b'-1672166631728511207',
  'rating': 1},
 {'userId': b'7022645187549453002',
  'contentId': b'-4374331682165863764',
  'rating': 2},
 {'userId': b'6879394870211872116',
  'contentId': b'5714314286511882372',
  'rating': 4},
 {'userId': b'-1479311724257856983',
  'contentId': b'-6451309518266745024',
  'rating': 4},
 {'userId': b'8239286975497580612',
  'contentId': b'-4110354420726924665',
  'rating': 4},
 {'userId': b'7022645187549453002',
  'contentId': b'-7292285110016212249',
  'rating': 5},
 {'userId': b'6879394870211872116',
  'contentId': b'-6151852268067518688',
  'rating': 5},
 {'userId': b'-108842214936804958',
  'contentId': b'2448026894306402386',
  'rating': 5},
 {'userId': b'3609194402293569455',
  'contentId': b'-2826566343807132236',
  'rating': 1},
 {'userId': b'344280948527967603',
  'contentId': b'-2148899391355011268',
  'rating': 1},
 {'userId': b'-1032019229384696495',
  'contentId': b'4119190424078847945',
  'rating': 4},
 {'userId': b'7781822014935525018',
  'contentId': b'-7926018713416777892',
  'rating': 3},
 {'userId': b'8239286975497580612',
  'contentId': b'3353902017498793780',
  'rating': 3},
 {'userId': b'3609194402293569455',
  'contentId': b'-9157338616628196758',
  'rating': 3},
 {'userId': b'-1387464358334758758',
  'contentId': b'1805789466376069146',
  'rating': 4},
 {'userId': b'-1387464358334758758',
  'contentId': b'-2081760549863309770',
  'rating': 5},
 {'userId': b'3609194402293569455',
  'contentId': b'-5170198873410718233',
  'rating': 2},
 {'userId': b'-1387464358334758758',
  'contentId': b'-3367778232969996503',
  'rating': 4},
 {'userId': b'-1387464358334758758',
  'contentId': b'4988225165850707692',
  'rating': 5},
 {'userId': b'-1387464358334758758',
  'contentId': b'-5917314377186856799',
  'rating': 2},
 {'userId': b'-8424644554119645763',
  'contentId': b'6157037646878010131',
  'rating': 5},
 {'userId': b'-1387464358334758758',
  'contentId': b'6023609667389715259',
  'rating': 4},
 {'userId': b'-8424644554119645763',
  'contentId': b'7905485530310717815',
  'rating': 4},
 {'userId': b'-1032019229384696495',
  'contentId': b'8194079557551008273',
  'rating': 4},
 {'userId': b'-1032019229384696495',
  'contentId': b'-1672166631728511207',
  'rating': 3},
 {'userId': b'-1387464358334758758',
  'contentId': b'-4374331682165863764',
  'rating': 4},
 {'userId': b'-1387464358334758758',
  'contentId': b'5714314286511882372',
  'rating': 5},
 {'userId': b'3609194402293569455',
  'contentId': b'-6451309518266745024',
  'rating': 5},
 {'userId': b'-1032019229384696495',
  'contentId': b'-4110354420726924665',
  'rating': 1},
 {'userId': b'-1387464358334758758',
  'contentId': b'-7292285110016212249',
  'rating': 4},
 {'userId': b'-1602833675167376798',
  'contentId': b'-6151852268067518688',
  'rating': 3},
 {'userId': b'-1602833675167376798',
  'contentId': b'2448026894306402386',
  'rating': 4},
 {'userId': b'5621833459783231486',
  'contentId': b'-2826566343807132236',
  'rating': 1},
 {'userId': b'-2626634673110551643',
  'contentId': b'-2148899391355011268',
  'rating': 3},
 {'userId': b'-1602833675167376798',
  'contentId': b'4119190424078847945',
  'rating': 5},
 {'userId': b'-108842214936804958',
  'contentId': b'-7926018713416777892',
  'rating': 5},
 {'userId': b'-6153009241569363021',
  'contentId': b'3353902017498793780',
  'rating': 4},
 {'userId': b'-4585796377251906117',
  'contentId': b'-9157338616628196758',
  'rating': 5},
 {'userId': b'-1602833675167376798',
  'contentId': b'1805789466376069146',
  'rating': 4},
 {'userId': b'-1602833675167376798',
  'contentId': b'-2081760549863309770',
  'rating': 5},
 {'userId': b'-108842214936804958',
  'contentId': b'-5170198873410718233',
  'rating': 4},
 {'userId': b'-2339455719722814827',
  'contentId': b'-3367778232969996503',
  'rating': 2},
 {'userId': b'5621833459783231486',
  'contentId': b'4988225165850707692',
  'rating': 3},
 {'userId': b'-1602833675167376798',
  'contentId': b'-5917314377186856799',
  'rating': 4},
 {'userId': b'4340306774493623681',
  'contentId': b'6157037646878010131',
  'rating': 5},
 {'userId': b'5621833459783231486',
  'contentId': b'6023609667389715259',
  'rating': 1},
 {'userId': b'5683029675627635125',
  'contentId': b'7905485530310717815',
  'rating': 3},
 {'userId': b'-1443636648652872475',
  'contentId': b'8194079557551008273',
  'rating': 3},
 {'userId': b'3891637997717104548',
  'contentId': b'-1672166631728511207',
  'rating': 1},
 {'userId': b'-108842214936804958',
  'contentId': b'-4374331682165863764',
  'rating': 5},
 {'userId': b'-2050699458865052139',
  'contentId': b'5714314286511882372',
  'rating': 1},
 {'userId': b'3429602690322213789',
  'contentId': b'-6451309518266745024',
  'rating': 1},
 {'userId': b'-2626634673110551643',
  'contentId': b'-4110354420726924665',
  'rating': 4},
 {'userId': b'-1602833675167376798',
  'contentId': b'-7292285110016212249',
  'rating': 2},
 {'userId': b'-1443636648652872475',
  'contentId': b'-6151852268067518688',
  'rating': 4},
 {'userId': b'-1443636648652872475',
  'contentId': b'2448026894306402386',
  'rating': 1},
 {'userId': b'4340306774493623681',
  'contentId': b'-2826566343807132236',
  'rating': 4}]

"""